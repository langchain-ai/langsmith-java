// File generated from our OpenAPI spec by Stainless.

package com.langchain.smith.models.datasets

import com.langchain.smith.core.JsonValue
import com.langchain.smith.models.feedback.AppFeedbackSource
import java.time.OffsetDateTime
import kotlin.jvm.optionals.getOrNull
import org.assertj.core.api.Assertions.assertThat
import org.junit.jupiter.api.Test

internal class DatasetUploadExperimentParamsTest {

    @Test
    fun create() {
        DatasetUploadExperimentParams.builder()
            .experimentEndTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
            .experimentName("experiment_name")
            .experimentStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
            .addResult(
                DatasetUploadExperimentParams.Result.builder()
                    .endTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .inputs(JsonValue.from(mapOf<String, Any>()))
                    .startTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .actualOutputs(JsonValue.from(mapOf<String, Any>()))
                    .error("error")
                    .addEvaluationScore(
                        FeedbackCreateCoreSchema.builder()
                            .key("key")
                            .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .comment("comment")
                            .comparativeExperimentId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .correction(JsonValue.from(mapOf<String, Any>()))
                            .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .extra(JsonValue.from(mapOf<String, Any>()))
                            .feedbackConfig(
                                FeedbackCreateCoreSchema.FeedbackConfig.builder()
                                    .type(FeedbackCreateCoreSchema.FeedbackConfig.Type.CONTINUOUS)
                                    .addCategory(
                                        FeedbackCreateCoreSchema.FeedbackConfig.Category.builder()
                                            .value(0.0)
                                            .label("x")
                                            .build()
                                    )
                                    .max(0.0)
                                    .min(0.0)
                                    .build()
                            )
                            .feedbackGroupId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .feedbackSource(
                                AppFeedbackSource.builder()
                                    .metadata(JsonValue.from(mapOf<String, Any>()))
                                    .type(AppFeedbackSource.Type.APP)
                                    .build()
                            )
                            .modifiedAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .score(0.0)
                            .value(0.0)
                            .build()
                    )
                    .expectedOutputs(JsonValue.from(mapOf<String, Any>()))
                    .rowId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .runMetadata(JsonValue.from(mapOf<String, Any>()))
                    .runName("run_name")
                    .build()
            )
            .datasetDescription("dataset_description")
            .datasetId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
            .datasetName("dataset_name")
            .experimentDescription("experiment_description")
            .experimentMetadata(JsonValue.from(mapOf<String, Any>()))
            .addSummaryExperimentScore(
                FeedbackCreateCoreSchema.builder()
                    .key("key")
                    .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .comment("comment")
                    .comparativeExperimentId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .correction(JsonValue.from(mapOf<String, Any>()))
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .extra(JsonValue.from(mapOf<String, Any>()))
                    .feedbackConfig(
                        FeedbackCreateCoreSchema.FeedbackConfig.builder()
                            .type(FeedbackCreateCoreSchema.FeedbackConfig.Type.CONTINUOUS)
                            .addCategory(
                                FeedbackCreateCoreSchema.FeedbackConfig.Category.builder()
                                    .value(0.0)
                                    .label("x")
                                    .build()
                            )
                            .max(0.0)
                            .min(0.0)
                            .build()
                    )
                    .feedbackGroupId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .feedbackSource(
                        AppFeedbackSource.builder()
                            .metadata(JsonValue.from(mapOf<String, Any>()))
                            .type(AppFeedbackSource.Type.APP)
                            .build()
                    )
                    .modifiedAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .score(0.0)
                    .value(0.0)
                    .build()
            )
            .build()
    }

    @Test
    fun body() {
        val params =
            DatasetUploadExperimentParams.builder()
                .experimentEndTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .experimentName("experiment_name")
                .experimentStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .addResult(
                    DatasetUploadExperimentParams.Result.builder()
                        .endTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .inputs(JsonValue.from(mapOf<String, Any>()))
                        .startTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .actualOutputs(JsonValue.from(mapOf<String, Any>()))
                        .error("error")
                        .addEvaluationScore(
                            FeedbackCreateCoreSchema.builder()
                                .key("key")
                                .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .comment("comment")
                                .comparativeExperimentId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .correction(JsonValue.from(mapOf<String, Any>()))
                                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .extra(JsonValue.from(mapOf<String, Any>()))
                                .feedbackConfig(
                                    FeedbackCreateCoreSchema.FeedbackConfig.builder()
                                        .type(
                                            FeedbackCreateCoreSchema.FeedbackConfig.Type.CONTINUOUS
                                        )
                                        .addCategory(
                                            FeedbackCreateCoreSchema.FeedbackConfig.Category
                                                .builder()
                                                .value(0.0)
                                                .label("x")
                                                .build()
                                        )
                                        .max(0.0)
                                        .min(0.0)
                                        .build()
                                )
                                .feedbackGroupId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .feedbackSource(
                                    AppFeedbackSource.builder()
                                        .metadata(JsonValue.from(mapOf<String, Any>()))
                                        .type(AppFeedbackSource.Type.APP)
                                        .build()
                                )
                                .modifiedAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .score(0.0)
                                .value(0.0)
                                .build()
                        )
                        .expectedOutputs(JsonValue.from(mapOf<String, Any>()))
                        .rowId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .runMetadata(JsonValue.from(mapOf<String, Any>()))
                        .runName("run_name")
                        .build()
                )
                .datasetDescription("dataset_description")
                .datasetId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .datasetName("dataset_name")
                .experimentDescription("experiment_description")
                .experimentMetadata(JsonValue.from(mapOf<String, Any>()))
                .addSummaryExperimentScore(
                    FeedbackCreateCoreSchema.builder()
                        .key("key")
                        .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .comment("comment")
                        .comparativeExperimentId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .correction(JsonValue.from(mapOf<String, Any>()))
                        .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .extra(JsonValue.from(mapOf<String, Any>()))
                        .feedbackConfig(
                            FeedbackCreateCoreSchema.FeedbackConfig.builder()
                                .type(FeedbackCreateCoreSchema.FeedbackConfig.Type.CONTINUOUS)
                                .addCategory(
                                    FeedbackCreateCoreSchema.FeedbackConfig.Category.builder()
                                        .value(0.0)
                                        .label("x")
                                        .build()
                                )
                                .max(0.0)
                                .min(0.0)
                                .build()
                        )
                        .feedbackGroupId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .feedbackSource(
                            AppFeedbackSource.builder()
                                .metadata(JsonValue.from(mapOf<String, Any>()))
                                .type(AppFeedbackSource.Type.APP)
                                .build()
                        )
                        .modifiedAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .score(0.0)
                        .value(0.0)
                        .build()
                )
                .build()

        val body = params._body()

        assertThat(body.experimentEndTime())
            .isEqualTo(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
        assertThat(body.experimentName()).isEqualTo("experiment_name")
        assertThat(body.experimentStartTime())
            .isEqualTo(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
        assertThat(body.results())
            .containsExactly(
                DatasetUploadExperimentParams.Result.builder()
                    .endTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .inputs(JsonValue.from(mapOf<String, Any>()))
                    .startTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .actualOutputs(JsonValue.from(mapOf<String, Any>()))
                    .error("error")
                    .addEvaluationScore(
                        FeedbackCreateCoreSchema.builder()
                            .key("key")
                            .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .comment("comment")
                            .comparativeExperimentId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .correction(JsonValue.from(mapOf<String, Any>()))
                            .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .extra(JsonValue.from(mapOf<String, Any>()))
                            .feedbackConfig(
                                FeedbackCreateCoreSchema.FeedbackConfig.builder()
                                    .type(FeedbackCreateCoreSchema.FeedbackConfig.Type.CONTINUOUS)
                                    .addCategory(
                                        FeedbackCreateCoreSchema.FeedbackConfig.Category.builder()
                                            .value(0.0)
                                            .label("x")
                                            .build()
                                    )
                                    .max(0.0)
                                    .min(0.0)
                                    .build()
                            )
                            .feedbackGroupId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .feedbackSource(
                                AppFeedbackSource.builder()
                                    .metadata(JsonValue.from(mapOf<String, Any>()))
                                    .type(AppFeedbackSource.Type.APP)
                                    .build()
                            )
                            .modifiedAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .score(0.0)
                            .value(0.0)
                            .build()
                    )
                    .expectedOutputs(JsonValue.from(mapOf<String, Any>()))
                    .rowId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .runMetadata(JsonValue.from(mapOf<String, Any>()))
                    .runName("run_name")
                    .build()
            )
        assertThat(body.datasetDescription()).contains("dataset_description")
        assertThat(body.datasetId()).contains("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
        assertThat(body.datasetName()).contains("dataset_name")
        assertThat(body.experimentDescription()).contains("experiment_description")
        assertThat(body._experimentMetadata()).isEqualTo(JsonValue.from(mapOf<String, Any>()))
        assertThat(body.summaryExperimentScores().getOrNull())
            .containsExactly(
                FeedbackCreateCoreSchema.builder()
                    .key("key")
                    .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .comment("comment")
                    .comparativeExperimentId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .correction(JsonValue.from(mapOf<String, Any>()))
                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .extra(JsonValue.from(mapOf<String, Any>()))
                    .feedbackConfig(
                        FeedbackCreateCoreSchema.FeedbackConfig.builder()
                            .type(FeedbackCreateCoreSchema.FeedbackConfig.Type.CONTINUOUS)
                            .addCategory(
                                FeedbackCreateCoreSchema.FeedbackConfig.Category.builder()
                                    .value(0.0)
                                    .label("x")
                                    .build()
                            )
                            .max(0.0)
                            .min(0.0)
                            .build()
                    )
                    .feedbackGroupId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .feedbackSource(
                        AppFeedbackSource.builder()
                            .metadata(JsonValue.from(mapOf<String, Any>()))
                            .type(AppFeedbackSource.Type.APP)
                            .build()
                    )
                    .modifiedAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .score(0.0)
                    .value(0.0)
                    .build()
            )
    }

    @Test
    fun bodyWithoutOptionalFields() {
        val params =
            DatasetUploadExperimentParams.builder()
                .experimentEndTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .experimentName("experiment_name")
                .experimentStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .addResult(
                    DatasetUploadExperimentParams.Result.builder()
                        .endTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .inputs(JsonValue.from(mapOf<String, Any>()))
                        .startTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .build()
                )
                .build()

        val body = params._body()

        assertThat(body.experimentEndTime())
            .isEqualTo(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
        assertThat(body.experimentName()).isEqualTo("experiment_name")
        assertThat(body.experimentStartTime())
            .isEqualTo(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
        assertThat(body.results())
            .containsExactly(
                DatasetUploadExperimentParams.Result.builder()
                    .endTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .inputs(JsonValue.from(mapOf<String, Any>()))
                    .startTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .build()
            )
    }
}
