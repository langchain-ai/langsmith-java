// File generated from our OpenAPI spec by Stainless.

package com.langchain.smith.models.public_.datasets.runs

import com.fasterxml.jackson.module.kotlin.jacksonTypeRef
import com.langchain.smith.core.JsonValue
import com.langchain.smith.core.jsonMapper
import com.langchain.smith.models.runs.RunTypeEnum
import java.time.OffsetDateTime
import kotlin.jvm.optionals.getOrNull
import org.assertj.core.api.Assertions.assertThat
import org.junit.jupiter.api.Test

internal class RunPublicDatasetSchemaTest {

    @Test
    fun create() {
        val runPublicDatasetSchema =
            RunPublicDatasetSchema.builder()
                .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .dottedOrder("dotted_order")
                .name("name")
                .runType(RunTypeEnum.TOOL)
                .sessionId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .status("status")
                .traceId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .addChildRunId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .completionCost("completion_cost")
                .completionCostDetails(
                    RunPublicDatasetSchema.CompletionCostDetails.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .completionTokenDetails(
                    RunPublicDatasetSchema.CompletionTokenDetails.builder()
                        .putAdditionalProperty("foo", JsonValue.from(0))
                        .build()
                )
                .completionTokens(0L)
                .addDirectChildRunId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .endTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .error("error")
                .addEvent(JsonValue.from(mapOf<String, Any>()))
                .executionOrder(1L)
                .extra(JsonValue.from(mapOf<String, Any>()))
                .feedbackStats(
                    RunPublicDatasetSchema.FeedbackStats.builder()
                        .putAdditionalProperty("foo", JsonValue.from(mapOf<String, Any>()))
                        .build()
                )
                .firstTokenTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .inputs(JsonValue.from(mapOf<String, Any>()))
                .inputsPreview("inputs_preview")
                .inputsS3Urls(JsonValue.from(mapOf<String, Any>()))
                .manifestId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .manifestS3Id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .outputs(JsonValue.from(mapOf<String, Any>()))
                .outputsPreview("outputs_preview")
                .outputsS3Urls(JsonValue.from(mapOf<String, Any>()))
                .parentRunId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .addParentRunId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .priceModelId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .promptCost("prompt_cost")
                .promptCostDetails(
                    RunPublicDatasetSchema.PromptCostDetails.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .promptTokenDetails(
                    RunPublicDatasetSchema.PromptTokenDetails.builder()
                        .putAdditionalProperty("foo", JsonValue.from(0))
                        .build()
                )
                .promptTokens(0L)
                .referenceExampleId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .s3Urls(JsonValue.from(mapOf<String, Any>()))
                .serialized(JsonValue.from(mapOf<String, Any>()))
                .startTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .addTag("string")
                .totalCost("total_cost")
                .totalTokens(0L)
                .traceMaxStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .traceMinStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .build()

        assertThat(runPublicDatasetSchema.id()).isEqualTo("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
        assertThat(runPublicDatasetSchema.dottedOrder()).isEqualTo("dotted_order")
        assertThat(runPublicDatasetSchema.name()).isEqualTo("name")
        assertThat(runPublicDatasetSchema.runType()).isEqualTo(RunTypeEnum.TOOL)
        assertThat(runPublicDatasetSchema.sessionId())
            .isEqualTo("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
        assertThat(runPublicDatasetSchema.status()).isEqualTo("status")
        assertThat(runPublicDatasetSchema.traceId())
            .isEqualTo("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
        assertThat(runPublicDatasetSchema.childRunIds().getOrNull())
            .containsExactly("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
        assertThat(runPublicDatasetSchema.completionCost()).contains("completion_cost")
        assertThat(runPublicDatasetSchema.completionCostDetails())
            .contains(
                RunPublicDatasetSchema.CompletionCostDetails.builder()
                    .putAdditionalProperty("foo", JsonValue.from("string"))
                    .build()
            )
        assertThat(runPublicDatasetSchema.completionTokenDetails())
            .contains(
                RunPublicDatasetSchema.CompletionTokenDetails.builder()
                    .putAdditionalProperty("foo", JsonValue.from(0))
                    .build()
            )
        assertThat(runPublicDatasetSchema.completionTokens()).contains(0L)
        assertThat(runPublicDatasetSchema.directChildRunIds().getOrNull())
            .containsExactly("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
        assertThat(runPublicDatasetSchema.endTime())
            .contains(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
        assertThat(runPublicDatasetSchema.error()).contains("error")
        assertThat(runPublicDatasetSchema.events().getOrNull())
            .containsExactly(JsonValue.from(mapOf<String, Any>()))
        assertThat(runPublicDatasetSchema.executionOrder()).contains(1L)
        assertThat(runPublicDatasetSchema._extra()).isEqualTo(JsonValue.from(mapOf<String, Any>()))
        assertThat(runPublicDatasetSchema.feedbackStats())
            .contains(
                RunPublicDatasetSchema.FeedbackStats.builder()
                    .putAdditionalProperty("foo", JsonValue.from(mapOf<String, Any>()))
                    .build()
            )
        assertThat(runPublicDatasetSchema.firstTokenTime())
            .contains(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
        assertThat(runPublicDatasetSchema._inputs()).isEqualTo(JsonValue.from(mapOf<String, Any>()))
        assertThat(runPublicDatasetSchema.inputsPreview()).contains("inputs_preview")
        assertThat(runPublicDatasetSchema._inputsS3Urls())
            .isEqualTo(JsonValue.from(mapOf<String, Any>()))
        assertThat(runPublicDatasetSchema.manifestId())
            .contains("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
        assertThat(runPublicDatasetSchema.manifestS3Id())
            .contains("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
        assertThat(runPublicDatasetSchema._outputs())
            .isEqualTo(JsonValue.from(mapOf<String, Any>()))
        assertThat(runPublicDatasetSchema.outputsPreview()).contains("outputs_preview")
        assertThat(runPublicDatasetSchema._outputsS3Urls())
            .isEqualTo(JsonValue.from(mapOf<String, Any>()))
        assertThat(runPublicDatasetSchema.parentRunId())
            .contains("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
        assertThat(runPublicDatasetSchema.parentRunIds().getOrNull())
            .containsExactly("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
        assertThat(runPublicDatasetSchema.priceModelId())
            .contains("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
        assertThat(runPublicDatasetSchema.promptCost()).contains("prompt_cost")
        assertThat(runPublicDatasetSchema.promptCostDetails())
            .contains(
                RunPublicDatasetSchema.PromptCostDetails.builder()
                    .putAdditionalProperty("foo", JsonValue.from("string"))
                    .build()
            )
        assertThat(runPublicDatasetSchema.promptTokenDetails())
            .contains(
                RunPublicDatasetSchema.PromptTokenDetails.builder()
                    .putAdditionalProperty("foo", JsonValue.from(0))
                    .build()
            )
        assertThat(runPublicDatasetSchema.promptTokens()).contains(0L)
        assertThat(runPublicDatasetSchema.referenceExampleId())
            .contains("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
        assertThat(runPublicDatasetSchema._s3Urls()).isEqualTo(JsonValue.from(mapOf<String, Any>()))
        assertThat(runPublicDatasetSchema._serialized())
            .isEqualTo(JsonValue.from(mapOf<String, Any>()))
        assertThat(runPublicDatasetSchema.startTime())
            .contains(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
        assertThat(runPublicDatasetSchema.tags().getOrNull()).containsExactly("string")
        assertThat(runPublicDatasetSchema.totalCost()).contains("total_cost")
        assertThat(runPublicDatasetSchema.totalTokens()).contains(0L)
        assertThat(runPublicDatasetSchema.traceMaxStartTime())
            .contains(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
        assertThat(runPublicDatasetSchema.traceMinStartTime())
            .contains(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
    }

    @Test
    fun roundtrip() {
        val jsonMapper = jsonMapper()
        val runPublicDatasetSchema =
            RunPublicDatasetSchema.builder()
                .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .dottedOrder("dotted_order")
                .name("name")
                .runType(RunTypeEnum.TOOL)
                .sessionId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .status("status")
                .traceId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .addChildRunId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .completionCost("completion_cost")
                .completionCostDetails(
                    RunPublicDatasetSchema.CompletionCostDetails.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .completionTokenDetails(
                    RunPublicDatasetSchema.CompletionTokenDetails.builder()
                        .putAdditionalProperty("foo", JsonValue.from(0))
                        .build()
                )
                .completionTokens(0L)
                .addDirectChildRunId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .endTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .error("error")
                .addEvent(JsonValue.from(mapOf<String, Any>()))
                .executionOrder(1L)
                .extra(JsonValue.from(mapOf<String, Any>()))
                .feedbackStats(
                    RunPublicDatasetSchema.FeedbackStats.builder()
                        .putAdditionalProperty("foo", JsonValue.from(mapOf<String, Any>()))
                        .build()
                )
                .firstTokenTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .inputs(JsonValue.from(mapOf<String, Any>()))
                .inputsPreview("inputs_preview")
                .inputsS3Urls(JsonValue.from(mapOf<String, Any>()))
                .manifestId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .manifestS3Id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .outputs(JsonValue.from(mapOf<String, Any>()))
                .outputsPreview("outputs_preview")
                .outputsS3Urls(JsonValue.from(mapOf<String, Any>()))
                .parentRunId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .addParentRunId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .priceModelId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .promptCost("prompt_cost")
                .promptCostDetails(
                    RunPublicDatasetSchema.PromptCostDetails.builder()
                        .putAdditionalProperty("foo", JsonValue.from("string"))
                        .build()
                )
                .promptTokenDetails(
                    RunPublicDatasetSchema.PromptTokenDetails.builder()
                        .putAdditionalProperty("foo", JsonValue.from(0))
                        .build()
                )
                .promptTokens(0L)
                .referenceExampleId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .s3Urls(JsonValue.from(mapOf<String, Any>()))
                .serialized(JsonValue.from(mapOf<String, Any>()))
                .startTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .addTag("string")
                .totalCost("total_cost")
                .totalTokens(0L)
                .traceMaxStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .traceMinStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .build()

        val roundtrippedRunPublicDatasetSchema =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(runPublicDatasetSchema),
                jacksonTypeRef<RunPublicDatasetSchema>(),
            )

        assertThat(roundtrippedRunPublicDatasetSchema).isEqualTo(runPublicDatasetSchema)
    }
}
