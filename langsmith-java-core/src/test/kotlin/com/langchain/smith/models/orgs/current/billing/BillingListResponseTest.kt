// File generated from our OpenAPI spec by Stainless.

package com.langchain.smith.models.orgs.current.billing

import com.fasterxml.jackson.module.kotlin.jacksonTypeRef
import com.langchain.smith.core.jsonMapper
import com.langchain.smith.models.orgs.PaymentPlanTier
import com.langchain.smith.models.orgs.current.CustomerVisiblePlanInfo
import com.langchain.smith.models.orgs.current.OrganizationConfig
import com.langchain.smith.models.orgs.current.StripePaymentMethodInfo
import java.time.OffsetDateTime
import org.assertj.core.api.Assertions.assertThat
import org.junit.jupiter.api.Test

internal class BillingListResponseTest {

    @Test
    fun create() {
        val billingListResponse =
            BillingListResponse.builder()
                .config(
                    OrganizationConfig.builder()
                        .allowCustomIframes(true)
                        .arbitraryCostTrackingEnabled(true)
                        .canAddSeats(true)
                        .canDisablePublicSharing(true)
                        .canServeDatasets(true)
                        .canUseAbac(true)
                        .canUseAgentBuilder(true)
                        .canUseBulkExport(true)
                        .canUseLanggraphCloud(true)
                        .canUseRbac(true)
                        .canUseSamlSso(true)
                        .clioEnabled(true)
                        .datadogRumSessionSampleRate(0L)
                        .demoLgpNewGraphEnabled(true)
                        .enableAlignEvaluators(true)
                        .enableIncludeExtendedStats(true)
                        .enableLanggraphPricing(true)
                        .enableLgpListenersPage(true)
                        .enableMarkdownInTracing(true)
                        .enableMonthlyUsageCharts(true)
                        .enableOrgUsageCharts(true)
                        .enablePricingRedesign(true)
                        .enableQueryingV2Endpoints(true)
                        .enableRunTreeStreaming(true)
                        .enableThreadViewPlayground(true)
                        .enableThreadsImprovements(true)
                        .kvDatasetMessageSupport(true)
                        .langgraphDeployOwnCloudEnabled(true)
                        .langgraphEnterpriseEnabled(true)
                        .langgraphRemoteReconcilerEnabled(true)
                        .langsmithAlertsLegacyPocEnabled(true)
                        .langsmithAlertsPocEnabled(true)
                        .langsmithExperimentalSearchEnabled(true)
                        .lgpTemplatesEnabled(true)
                        .maxFreeLanggraphCloudDeployments(0L)
                        .maxIdentities(0L)
                        .maxLanggraphCloudDeployments(0L)
                        .maxPromptWebhooks(0L)
                        .maxThreadEvaluatorsPerTenant(0L)
                        .maxWorkspaces(0L)
                        .newRuleEvaluatorCreationVersion(0L)
                        .partnerPlanApprovalDate("partner_plan_approval_date")
                        .playgroundEvaluatorStrategy("playground_evaluator_strategy")
                        .premierPlanApprovalDate("premier_plan_approval_date")
                        .promptOptimizationJobsEnabled(true)
                        .requireCodeEvaluatorLanguageField(true)
                        .showPlaygroundPromptCanvas(true)
                        .showUpdatedResourceTags(true)
                        .showUpdatedSidenav(true)
                        .startupPlanApprovalDate("startup_plan_approval_date")
                        .tenantSkipTopkFacets(true)
                        .threadEvaluatorsEnabled(true)
                        .useExactSearchForPrompts(true)
                        .usePythonPlaygroundService(true)
                        .build()
                )
                .connectedToMetronome(true)
                .connectedToStripe(true)
                .displayName("display_name")
                .isPersonal(true)
                .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .currentPlan(
                    CustomerVisiblePlanInfo.builder()
                        .startedOn(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .tier(PaymentPlanTier.NO_PLAN)
                        .endsOn(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .build()
                )
                .defaultSsoProvision(true)
                .disabled(true)
                .endOfBillingPeriod(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .paymentMethod(
                    StripePaymentMethodInfo.builder()
                        .brand("brand")
                        .email("email")
                        .expMonth(0L)
                        .expYear(0L)
                        .last4("last4")
                        .build()
                )
                .reachedMaxWorkspaces(true)
                .tier(PaymentPlanTier.NO_PLAN)
                .upcomingPlan(
                    CustomerVisiblePlanInfo.builder()
                        .startedOn(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .tier(PaymentPlanTier.NO_PLAN)
                        .endsOn(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .build()
                )
                .build()

        assertThat(billingListResponse.config())
            .isEqualTo(
                OrganizationConfig.builder()
                    .allowCustomIframes(true)
                    .arbitraryCostTrackingEnabled(true)
                    .canAddSeats(true)
                    .canDisablePublicSharing(true)
                    .canServeDatasets(true)
                    .canUseAbac(true)
                    .canUseAgentBuilder(true)
                    .canUseBulkExport(true)
                    .canUseLanggraphCloud(true)
                    .canUseRbac(true)
                    .canUseSamlSso(true)
                    .clioEnabled(true)
                    .datadogRumSessionSampleRate(0L)
                    .demoLgpNewGraphEnabled(true)
                    .enableAlignEvaluators(true)
                    .enableIncludeExtendedStats(true)
                    .enableLanggraphPricing(true)
                    .enableLgpListenersPage(true)
                    .enableMarkdownInTracing(true)
                    .enableMonthlyUsageCharts(true)
                    .enableOrgUsageCharts(true)
                    .enablePricingRedesign(true)
                    .enableQueryingV2Endpoints(true)
                    .enableRunTreeStreaming(true)
                    .enableThreadViewPlayground(true)
                    .enableThreadsImprovements(true)
                    .kvDatasetMessageSupport(true)
                    .langgraphDeployOwnCloudEnabled(true)
                    .langgraphEnterpriseEnabled(true)
                    .langgraphRemoteReconcilerEnabled(true)
                    .langsmithAlertsLegacyPocEnabled(true)
                    .langsmithAlertsPocEnabled(true)
                    .langsmithExperimentalSearchEnabled(true)
                    .lgpTemplatesEnabled(true)
                    .maxFreeLanggraphCloudDeployments(0L)
                    .maxIdentities(0L)
                    .maxLanggraphCloudDeployments(0L)
                    .maxPromptWebhooks(0L)
                    .maxThreadEvaluatorsPerTenant(0L)
                    .maxWorkspaces(0L)
                    .newRuleEvaluatorCreationVersion(0L)
                    .partnerPlanApprovalDate("partner_plan_approval_date")
                    .playgroundEvaluatorStrategy("playground_evaluator_strategy")
                    .premierPlanApprovalDate("premier_plan_approval_date")
                    .promptOptimizationJobsEnabled(true)
                    .requireCodeEvaluatorLanguageField(true)
                    .showPlaygroundPromptCanvas(true)
                    .showUpdatedResourceTags(true)
                    .showUpdatedSidenav(true)
                    .startupPlanApprovalDate("startup_plan_approval_date")
                    .tenantSkipTopkFacets(true)
                    .threadEvaluatorsEnabled(true)
                    .useExactSearchForPrompts(true)
                    .usePythonPlaygroundService(true)
                    .build()
            )
        assertThat(billingListResponse.connectedToMetronome()).isEqualTo(true)
        assertThat(billingListResponse.connectedToStripe()).isEqualTo(true)
        assertThat(billingListResponse.displayName()).isEqualTo("display_name")
        assertThat(billingListResponse.isPersonal()).isEqualTo(true)
        assertThat(billingListResponse.id()).contains("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
        assertThat(billingListResponse.currentPlan())
            .contains(
                CustomerVisiblePlanInfo.builder()
                    .startedOn(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .tier(PaymentPlanTier.NO_PLAN)
                    .endsOn(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .build()
            )
        assertThat(billingListResponse.defaultSsoProvision()).contains(true)
        assertThat(billingListResponse.disabled()).contains(true)
        assertThat(billingListResponse.endOfBillingPeriod())
            .contains(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
        assertThat(billingListResponse.paymentMethod())
            .contains(
                StripePaymentMethodInfo.builder()
                    .brand("brand")
                    .email("email")
                    .expMonth(0L)
                    .expYear(0L)
                    .last4("last4")
                    .build()
            )
        assertThat(billingListResponse.reachedMaxWorkspaces()).contains(true)
        assertThat(billingListResponse.tier()).contains(PaymentPlanTier.NO_PLAN)
        assertThat(billingListResponse.upcomingPlan())
            .contains(
                CustomerVisiblePlanInfo.builder()
                    .startedOn(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .tier(PaymentPlanTier.NO_PLAN)
                    .endsOn(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .build()
            )
    }

    @Test
    fun roundtrip() {
        val jsonMapper = jsonMapper()
        val billingListResponse =
            BillingListResponse.builder()
                .config(
                    OrganizationConfig.builder()
                        .allowCustomIframes(true)
                        .arbitraryCostTrackingEnabled(true)
                        .canAddSeats(true)
                        .canDisablePublicSharing(true)
                        .canServeDatasets(true)
                        .canUseAbac(true)
                        .canUseAgentBuilder(true)
                        .canUseBulkExport(true)
                        .canUseLanggraphCloud(true)
                        .canUseRbac(true)
                        .canUseSamlSso(true)
                        .clioEnabled(true)
                        .datadogRumSessionSampleRate(0L)
                        .demoLgpNewGraphEnabled(true)
                        .enableAlignEvaluators(true)
                        .enableIncludeExtendedStats(true)
                        .enableLanggraphPricing(true)
                        .enableLgpListenersPage(true)
                        .enableMarkdownInTracing(true)
                        .enableMonthlyUsageCharts(true)
                        .enableOrgUsageCharts(true)
                        .enablePricingRedesign(true)
                        .enableQueryingV2Endpoints(true)
                        .enableRunTreeStreaming(true)
                        .enableThreadViewPlayground(true)
                        .enableThreadsImprovements(true)
                        .kvDatasetMessageSupport(true)
                        .langgraphDeployOwnCloudEnabled(true)
                        .langgraphEnterpriseEnabled(true)
                        .langgraphRemoteReconcilerEnabled(true)
                        .langsmithAlertsLegacyPocEnabled(true)
                        .langsmithAlertsPocEnabled(true)
                        .langsmithExperimentalSearchEnabled(true)
                        .lgpTemplatesEnabled(true)
                        .maxFreeLanggraphCloudDeployments(0L)
                        .maxIdentities(0L)
                        .maxLanggraphCloudDeployments(0L)
                        .maxPromptWebhooks(0L)
                        .maxThreadEvaluatorsPerTenant(0L)
                        .maxWorkspaces(0L)
                        .newRuleEvaluatorCreationVersion(0L)
                        .partnerPlanApprovalDate("partner_plan_approval_date")
                        .playgroundEvaluatorStrategy("playground_evaluator_strategy")
                        .premierPlanApprovalDate("premier_plan_approval_date")
                        .promptOptimizationJobsEnabled(true)
                        .requireCodeEvaluatorLanguageField(true)
                        .showPlaygroundPromptCanvas(true)
                        .showUpdatedResourceTags(true)
                        .showUpdatedSidenav(true)
                        .startupPlanApprovalDate("startup_plan_approval_date")
                        .tenantSkipTopkFacets(true)
                        .threadEvaluatorsEnabled(true)
                        .useExactSearchForPrompts(true)
                        .usePythonPlaygroundService(true)
                        .build()
                )
                .connectedToMetronome(true)
                .connectedToStripe(true)
                .displayName("display_name")
                .isPersonal(true)
                .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .currentPlan(
                    CustomerVisiblePlanInfo.builder()
                        .startedOn(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .tier(PaymentPlanTier.NO_PLAN)
                        .endsOn(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .build()
                )
                .defaultSsoProvision(true)
                .disabled(true)
                .endOfBillingPeriod(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .paymentMethod(
                    StripePaymentMethodInfo.builder()
                        .brand("brand")
                        .email("email")
                        .expMonth(0L)
                        .expYear(0L)
                        .last4("last4")
                        .build()
                )
                .reachedMaxWorkspaces(true)
                .tier(PaymentPlanTier.NO_PLAN)
                .upcomingPlan(
                    CustomerVisiblePlanInfo.builder()
                        .startedOn(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .tier(PaymentPlanTier.NO_PLAN)
                        .endsOn(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .build()
                )
                .build()

        val roundtrippedBillingListResponse =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(billingListResponse),
                jacksonTypeRef<BillingListResponse>(),
            )

        assertThat(roundtrippedBillingListResponse).isEqualTo(billingListResponse)
    }
}
