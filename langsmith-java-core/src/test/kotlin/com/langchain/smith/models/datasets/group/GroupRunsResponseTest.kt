// File generated from our OpenAPI spec by Stainless.

package com.langchain.smith.models.datasets.group

import com.fasterxml.jackson.module.kotlin.jacksonTypeRef
import com.langchain.smith.core.JsonValue
import com.langchain.smith.core.jsonMapper
import com.langchain.smith.models.datasets.runs.ExampleWithRunsCh
import java.time.OffsetDateTime
import org.assertj.core.api.Assertions.assertThat
import org.junit.jupiter.api.Test

internal class GroupRunsResponseTest {

    @Test
    fun create() {
        val groupRunsResponse =
            GroupRunsResponse.builder()
                .addGroup(
                    GroupRunsResponse.Group.builder()
                        .exampleCount(0L)
                        .addExample(
                            ExampleWithRunsCh.builder()
                                .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .datasetId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .inputs(JsonValue.from(mapOf<String, Any>()))
                                .name("name")
                                .addRun(
                                    ExampleWithRunsCh.Run.builder()
                                        .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .name("name")
                                        .runType(ExampleWithRunsCh.Run.RunType.TOOL)
                                        .sessionId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .status("status")
                                        .traceId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .appPath("app_path")
                                        .completionCost("completion_cost")
                                        .completionTokens(0L)
                                        .dottedOrder("dotted_order")
                                        .endTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                        .error("error")
                                        .addEvent(JsonValue.from(mapOf<String, Any>()))
                                        .executionOrder(1L)
                                        .extra(JsonValue.from(mapOf<String, Any>()))
                                        .feedbackStats(
                                            ExampleWithRunsCh.Run.FeedbackStats.builder()
                                                .putAdditionalProperty(
                                                    "foo",
                                                    JsonValue.from(mapOf<String, Any>()),
                                                )
                                                .build()
                                        )
                                        .inputs(JsonValue.from(mapOf<String, Any>()))
                                        .inputsPreview("inputs_preview")
                                        .inputsS3Urls(JsonValue.from(mapOf<String, Any>()))
                                        .manifestId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .manifestS3Id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .outputs(JsonValue.from(mapOf<String, Any>()))
                                        .outputsPreview("outputs_preview")
                                        .outputsS3Urls(JsonValue.from(mapOf<String, Any>()))
                                        .parentRunId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .promptCost("prompt_cost")
                                        .promptTokens(0L)
                                        .referenceExampleId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .s3Urls(JsonValue.from(mapOf<String, Any>()))
                                        .serialized(JsonValue.from(mapOf<String, Any>()))
                                        .startTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                        .addTag("string")
                                        .totalCost("total_cost")
                                        .totalTokens(0L)
                                        .traceMaxStartTime(
                                            OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                        )
                                        .traceMinStartTime(
                                            OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                        )
                                        .build()
                                )
                                .attachmentUrls(JsonValue.from(mapOf<String, Any>()))
                                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .metadata(JsonValue.from(mapOf<String, Any>()))
                                .modifiedAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .outputs(JsonValue.from(mapOf<String, Any>()))
                                .sourceRunId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .build()
                        )
                        .filter("filter")
                        .groupKey("string")
                        .addSession(
                            GroupRunsResponse.Group.Session.builder()
                                .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .filter("filter")
                                .tenantId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .completionCost("completion_cost")
                                .completionTokens(0L)
                                .defaultDatasetId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .description("description")
                                .endTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .errorRate(0.0)
                                .exampleCount(0L)
                                .extra(JsonValue.from(mapOf<String, Any>()))
                                .feedbackStats(JsonValue.from(mapOf<String, Any>()))
                                .firstTokenP50(0.0)
                                .firstTokenP99(0.0)
                                .lastRunStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .lastRunStartTimeLive(
                                    OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                )
                                .latencyP50(0.0)
                                .latencyP99(0.0)
                                .maxStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .minStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .name("name")
                                .promptCost("prompt_cost")
                                .promptTokens(0L)
                                .referenceDatasetId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .runCount(0L)
                                .addRunFacet(JsonValue.from(mapOf<String, Any>()))
                                .sessionFeedbackStats(JsonValue.from(mapOf<String, Any>()))
                                .startTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .streamingRate(0.0)
                                .testRunNumber(0L)
                                .totalCost("total_cost")
                                .totalTokens(0L)
                                .traceTier(GroupRunsResponse.Group.Session.TraceTier.LONGLIVED)
                                .build()
                        )
                        .completionCost("completion_cost")
                        .completionTokens(0L)
                        .count(0L)
                        .errorRate(0.0)
                        .feedbackStats(JsonValue.from(mapOf<String, Any>()))
                        .latencyP50(0.0)
                        .latencyP99(0.0)
                        .maxStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .minStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .promptCost("prompt_cost")
                        .promptTokens(0L)
                        .totalCost("total_cost")
                        .totalTokens(0L)
                        .build()
                )
                .build()

        assertThat(groupRunsResponse.groups())
            .containsExactly(
                GroupRunsResponse.Group.builder()
                    .exampleCount(0L)
                    .addExample(
                        ExampleWithRunsCh.builder()
                            .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .datasetId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .inputs(JsonValue.from(mapOf<String, Any>()))
                            .name("name")
                            .addRun(
                                ExampleWithRunsCh.Run.builder()
                                    .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                    .name("name")
                                    .runType(ExampleWithRunsCh.Run.RunType.TOOL)
                                    .sessionId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                    .status("status")
                                    .traceId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                    .appPath("app_path")
                                    .completionCost("completion_cost")
                                    .completionTokens(0L)
                                    .dottedOrder("dotted_order")
                                    .endTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                    .error("error")
                                    .addEvent(JsonValue.from(mapOf<String, Any>()))
                                    .executionOrder(1L)
                                    .extra(JsonValue.from(mapOf<String, Any>()))
                                    .feedbackStats(
                                        ExampleWithRunsCh.Run.FeedbackStats.builder()
                                            .putAdditionalProperty(
                                                "foo",
                                                JsonValue.from(mapOf<String, Any>()),
                                            )
                                            .build()
                                    )
                                    .inputs(JsonValue.from(mapOf<String, Any>()))
                                    .inputsPreview("inputs_preview")
                                    .inputsS3Urls(JsonValue.from(mapOf<String, Any>()))
                                    .manifestId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                    .manifestS3Id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                    .outputs(JsonValue.from(mapOf<String, Any>()))
                                    .outputsPreview("outputs_preview")
                                    .outputsS3Urls(JsonValue.from(mapOf<String, Any>()))
                                    .parentRunId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                    .promptCost("prompt_cost")
                                    .promptTokens(0L)
                                    .referenceExampleId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                    .s3Urls(JsonValue.from(mapOf<String, Any>()))
                                    .serialized(JsonValue.from(mapOf<String, Any>()))
                                    .startTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                    .addTag("string")
                                    .totalCost("total_cost")
                                    .totalTokens(0L)
                                    .traceMaxStartTime(
                                        OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                    )
                                    .traceMinStartTime(
                                        OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                    )
                                    .build()
                            )
                            .attachmentUrls(JsonValue.from(mapOf<String, Any>()))
                            .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .metadata(JsonValue.from(mapOf<String, Any>()))
                            .modifiedAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .outputs(JsonValue.from(mapOf<String, Any>()))
                            .sourceRunId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .build()
                    )
                    .filter("filter")
                    .groupKey("string")
                    .addSession(
                        GroupRunsResponse.Group.Session.builder()
                            .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .filter("filter")
                            .tenantId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .completionCost("completion_cost")
                            .completionTokens(0L)
                            .defaultDatasetId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .description("description")
                            .endTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .errorRate(0.0)
                            .exampleCount(0L)
                            .extra(JsonValue.from(mapOf<String, Any>()))
                            .feedbackStats(JsonValue.from(mapOf<String, Any>()))
                            .firstTokenP50(0.0)
                            .firstTokenP99(0.0)
                            .lastRunStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .lastRunStartTimeLive(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .latencyP50(0.0)
                            .latencyP99(0.0)
                            .maxStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .minStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .name("name")
                            .promptCost("prompt_cost")
                            .promptTokens(0L)
                            .referenceDatasetId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .runCount(0L)
                            .addRunFacet(JsonValue.from(mapOf<String, Any>()))
                            .sessionFeedbackStats(JsonValue.from(mapOf<String, Any>()))
                            .startTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .streamingRate(0.0)
                            .testRunNumber(0L)
                            .totalCost("total_cost")
                            .totalTokens(0L)
                            .traceTier(GroupRunsResponse.Group.Session.TraceTier.LONGLIVED)
                            .build()
                    )
                    .completionCost("completion_cost")
                    .completionTokens(0L)
                    .count(0L)
                    .errorRate(0.0)
                    .feedbackStats(JsonValue.from(mapOf<String, Any>()))
                    .latencyP50(0.0)
                    .latencyP99(0.0)
                    .maxStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .minStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .promptCost("prompt_cost")
                    .promptTokens(0L)
                    .totalCost("total_cost")
                    .totalTokens(0L)
                    .build()
            )
    }

    @Test
    fun roundtrip() {
        val jsonMapper = jsonMapper()
        val groupRunsResponse =
            GroupRunsResponse.builder()
                .addGroup(
                    GroupRunsResponse.Group.builder()
                        .exampleCount(0L)
                        .addExample(
                            ExampleWithRunsCh.builder()
                                .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .datasetId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .inputs(JsonValue.from(mapOf<String, Any>()))
                                .name("name")
                                .addRun(
                                    ExampleWithRunsCh.Run.builder()
                                        .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .name("name")
                                        .runType(ExampleWithRunsCh.Run.RunType.TOOL)
                                        .sessionId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .status("status")
                                        .traceId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .appPath("app_path")
                                        .completionCost("completion_cost")
                                        .completionTokens(0L)
                                        .dottedOrder("dotted_order")
                                        .endTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                        .error("error")
                                        .addEvent(JsonValue.from(mapOf<String, Any>()))
                                        .executionOrder(1L)
                                        .extra(JsonValue.from(mapOf<String, Any>()))
                                        .feedbackStats(
                                            ExampleWithRunsCh.Run.FeedbackStats.builder()
                                                .putAdditionalProperty(
                                                    "foo",
                                                    JsonValue.from(mapOf<String, Any>()),
                                                )
                                                .build()
                                        )
                                        .inputs(JsonValue.from(mapOf<String, Any>()))
                                        .inputsPreview("inputs_preview")
                                        .inputsS3Urls(JsonValue.from(mapOf<String, Any>()))
                                        .manifestId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .manifestS3Id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .outputs(JsonValue.from(mapOf<String, Any>()))
                                        .outputsPreview("outputs_preview")
                                        .outputsS3Urls(JsonValue.from(mapOf<String, Any>()))
                                        .parentRunId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .promptCost("prompt_cost")
                                        .promptTokens(0L)
                                        .referenceExampleId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .s3Urls(JsonValue.from(mapOf<String, Any>()))
                                        .serialized(JsonValue.from(mapOf<String, Any>()))
                                        .startTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                        .addTag("string")
                                        .totalCost("total_cost")
                                        .totalTokens(0L)
                                        .traceMaxStartTime(
                                            OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                        )
                                        .traceMinStartTime(
                                            OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                        )
                                        .build()
                                )
                                .attachmentUrls(JsonValue.from(mapOf<String, Any>()))
                                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .metadata(JsonValue.from(mapOf<String, Any>()))
                                .modifiedAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .outputs(JsonValue.from(mapOf<String, Any>()))
                                .sourceRunId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .build()
                        )
                        .filter("filter")
                        .groupKey("string")
                        .addSession(
                            GroupRunsResponse.Group.Session.builder()
                                .id("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .filter("filter")
                                .tenantId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .completionCost("completion_cost")
                                .completionTokens(0L)
                                .defaultDatasetId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .description("description")
                                .endTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .errorRate(0.0)
                                .exampleCount(0L)
                                .extra(JsonValue.from(mapOf<String, Any>()))
                                .feedbackStats(JsonValue.from(mapOf<String, Any>()))
                                .firstTokenP50(0.0)
                                .firstTokenP99(0.0)
                                .lastRunStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .lastRunStartTimeLive(
                                    OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                )
                                .latencyP50(0.0)
                                .latencyP99(0.0)
                                .maxStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .minStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .name("name")
                                .promptCost("prompt_cost")
                                .promptTokens(0L)
                                .referenceDatasetId("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .runCount(0L)
                                .addRunFacet(JsonValue.from(mapOf<String, Any>()))
                                .sessionFeedbackStats(JsonValue.from(mapOf<String, Any>()))
                                .startTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .streamingRate(0.0)
                                .testRunNumber(0L)
                                .totalCost("total_cost")
                                .totalTokens(0L)
                                .traceTier(GroupRunsResponse.Group.Session.TraceTier.LONGLIVED)
                                .build()
                        )
                        .completionCost("completion_cost")
                        .completionTokens(0L)
                        .count(0L)
                        .errorRate(0.0)
                        .feedbackStats(JsonValue.from(mapOf<String, Any>()))
                        .latencyP50(0.0)
                        .latencyP99(0.0)
                        .maxStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .minStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .promptCost("prompt_cost")
                        .promptTokens(0L)
                        .totalCost("total_cost")
                        .totalTokens(0L)
                        .build()
                )
                .build()

        val roundtrippedGroupRunsResponse =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(groupRunsResponse),
                jacksonTypeRef<GroupRunsResponse>(),
            )

        assertThat(roundtrippedGroupRunsResponse).isEqualTo(groupRunsResponse)
    }
}
